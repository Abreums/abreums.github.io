mutate(bid_classification = case_when(
str_detect(bid_classification, "Legal") ~ "Legal Requirement",
str_detect(bid_classification, "Integration") ~ "3rd Party Integration",
str_detect(bid_classification, "Waiting") ~ "3rd Party Integration",
TRUE ~ bid_classification
)) |>
count(stream, bid_classification, wt = n) |>
group_by(stream) |>
mutate(`Total by Area` = sum(n)) |>
ungroup() |>
pivot_wider(names_from = bid_classification,
values_from = n) |>
relocate(`Legal Requirement`, .after = last_col()) |>
relocate(`3rd Party Integration`, .after = last_col()) |>
relocate(`Baseline & Localization`, .after = last_col()) |>
relocate(`Deviation from Global way of working`, .after = last_col()) |>
relocate(`Total by Area`, .after = last_col()) |>
arrange(`Total by Area`) |>
# mutate(color = "") |>
gt(rowname_col = "stream") |>
tab_header(
title = md(paste("BID Quantities", fontawesome::fa("city") , "FMS-SAP")),
subtitle = "Status at 2023-12-19"
) |>
sub_missing()  |>
grand_summary_rows(
# columns = -c(color),
fns = list(
total = ~ sum(., na.rm = TRUE)
)
) |>
tab_options(
table.font.size = 24
) |>
tab_style(
style = cell_fill(color = "pink"),
locations = cells_grand_summary(
columns = `Deviation from Global way of working`,
rows = 1
)
) |>
# |>
# data_color(
#   columns = `Total by Area`,
#   rows =  `Total by Area` > 15,
#   method = "numeric",
#   palette = c("lightblue", "pink"),
#   domain = c(0, 20)
# )  |>
# data_color(
#   columns = `3rd Party Integration`,
#   rows =  `3rd Party Integration` > 5,
#   method = "numeric",
#   palette = c("lightblue", "pink"),
#   domain = c(0, 10)
# )  |>
cols_label(
`Legal Requirement` = `Legal<br>Requirement`,
`3rd Party Integration` = `3rd Party<br>Integration`,
`Baseline & Localization` = `Baseline &<br>Localization`,
`Deviation from Global way of working` = `Deviation<br>from Global<br>way of<br>working`,
`Total by Area` = "",
.fn = md
)
in_data_s2 |>
filter(!is.na(stream)) |>
filter(!str_detect(status, "99. Cancelled")) |>
filter(!is.na(charm_number)) |>
filter(!str_detect(charm_number, "Wait")) |>
filter(!str_detect(charm_number, "NA")) |>
select(stream, charm_number, bid_classification) |>
count(stream, bid_classification, sort = T) |>
filter(!is.na(bid_classification)) |>
filter(!str_detect(bid_classification, "NA")) |>
filter(!str_detect(bid_classification, "template")) |>
mutate(bid_classification = case_when(
str_detect(bid_classification, "Legal") ~ "Legal Requirement",
str_detect(bid_classification, "Integration") ~ "3rd Party Integration",
str_detect(bid_classification, "Waiting") ~ "3rd Party Integration",
TRUE ~ bid_classification
)) |>
count(stream, bid_classification, wt = n) |>
group_by(stream) |>
mutate(`Total by Area` = sum(n)) |>
ungroup() |>
pivot_wider(names_from = bid_classification,
values_from = n) |>
relocate(`Legal Requirement`, .after = last_col()) |>
relocate(`3rd Party Integration`, .after = last_col()) |>
relocate(`Baseline & Localization`, .after = last_col()) |>
relocate(`Deviation from Global way of working`, .after = last_col()) |>
relocate(`Total by Area`, .after = last_col()) |>
arrange(`Total by Area`) |>
# mutate(color = "") |>
gt(rowname_col = "stream") |>
tab_header(
title = md(paste("BID Quantities", fontawesome::fa("city") , "FMS-SAP")),
subtitle = "Status at 2023-12-19"
) |>
sub_missing()  |>
grand_summary_rows(
# columns = -c(color),
fns = list(
total = ~ sum(., na.rm = TRUE)
)
) |>
tab_options(
table.font.size = 24
) |>
tab_style(
style = cell_fill(color = "pink"),
locations = cells_grand_summary(
columns = `Deviation from Global way of working`,
rows = 1
)
) |>
# |>
# data_color(
#   columns = `Total by Area`,
#   rows =  `Total by Area` > 15,
#   method = "numeric",
#   palette = c("lightblue", "pink"),
#   domain = c(0, 20)
# )  |>
# data_color(
#   columns = `3rd Party Integration`,
#   rows =  `3rd Party Integration` > 5,
#   method = "numeric",
#   palette = c("lightblue", "pink"),
#   domain = c(0, 10)
# )  |>
cols_label(
`Legal Requirement` = "Legal<br>Requirement",
`3rd Party Integration` = "3rd Party<br>Integration",
`Baseline & Localization` = "Baseline &<br>Localization",
`Deviation from Global way of working` = "Deviation<br>from Global<br>way of<br>working",
`Total by Area` = "",
.fn = md
)
in_data_s2 |>
filter(!is.na(stream)) |>
filter(!str_detect(status, "99. Cancelled")) |>
filter(!is.na(charm_number)) |>
filter(!str_detect(charm_number, "Wait")) |>
filter(!str_detect(charm_number, "NA")) |>
select(stream, charm_number, bid_classification) |>
count(stream, bid_classification, sort = T) |>
filter(!is.na(bid_classification)) |>
filter(!str_detect(bid_classification, "NA")) |>
filter(!str_detect(bid_classification, "template")) |>
mutate(bid_classification = case_when(
str_detect(bid_classification, "Legal") ~ "Legal Requirement",
str_detect(bid_classification, "Integration") ~ "3rd Party Integration",
str_detect(bid_classification, "Waiting") ~ "3rd Party Integration",
TRUE ~ bid_classification
)) |>
count(stream, bid_classification, wt = n) |>
group_by(stream) |>
mutate(`Total by Area` = sum(n)) |>
ungroup() |>
pivot_wider(names_from = bid_classification,
values_from = n) |>
relocate(`Legal Requirement`, .after = last_col()) |>
relocate(`3rd Party Integration`, .after = last_col()) |>
relocate(`Baseline & Localization`, .after = last_col()) |>
relocate(`Deviation from Global way of working`, .after = last_col()) |>
relocate(`Total by Area`, .after = last_col()) |>
arrange(`Total by Area`) |>
# mutate(color = "") |>
gt(rowname_col = "stream") |>
tab_header(
title = md(paste("BID Quantities", fontawesome::fa("city") , "FMS-SAP")),
subtitle = "Status at 2023-12-19"
) |>
sub_missing()  |>
grand_summary_rows(
# columns = -c(color),
fns = list(
total = ~ sum(., na.rm = TRUE)
)
) |>
tab_options(
table.font.size = 24
) |>
tab_style(
style = cell_fill(color = "pink"),
locations = cells_grand_summary(
columns = `Deviation from Global way of working`,
rows = 1
)
) |>
# |>
# data_color(
#   columns = `Total by Area`,
#   rows =  `Total by Area` > 15,
#   method = "numeric",
#   palette = c("lightblue", "pink"),
#   domain = c(0, 20)
# )  |>
# data_color(
#   columns = `3rd Party Integration`,
#   rows =  `3rd Party Integration` > 5,
#   method = "numeric",
#   palette = c("lightblue", "pink"),
#   domain = c(0, 10)
# )  |>
cols_label(
`Legal Requirement` = "Legal<br>Requirement",
`3rd Party Integration` = "3rd Party<br>Integration",
`Baseline & Localization` = "Baseline &<br>Localization",
`Deviation from Global way of working` = "Deviation<br>from Global<br>way of<br>working",
`Total by Area` = "Totals",
.fn = md
)
in_data_s2 |>
filter(!is.na(stream)) |>
filter(!str_detect(status, "99. Cancelled")) |>
filter(!is.na(charm_number)) |>
filter(!str_detect(charm_number, "Wait")) |>
filter(!str_detect(charm_number, "NA")) |>
select(stream, charm_number, bid_classification) |>
count(stream, bid_classification, sort = T) |>
filter(!is.na(bid_classification)) |>
filter(!str_detect(bid_classification, "NA")) |>
filter(!str_detect(bid_classification, "template")) |>
mutate(bid_classification = case_when(
str_detect(bid_classification, "Legal") ~ "Legal Requirement",
str_detect(bid_classification, "Integration") ~ "3rd Party Integration",
str_detect(bid_classification, "Waiting") ~ "3rd Party Integration",
TRUE ~ bid_classification
)) |>
count(stream, bid_classification, wt = n) |>
group_by(stream) |>
mutate(`Total by Area` = sum(n)) |>
ungroup() |>
pivot_wider(names_from = bid_classification,
values_from = n) |>
relocate(`Legal Requirement`, .after = last_col()) |>
relocate(`3rd Party Integration`, .after = last_col()) |>
relocate(`Baseline & Localization`, .after = last_col()) |>
relocate(`Deviation from Global way of working`, .after = last_col()) |>
relocate(`Total by Area`, .after = last_col()) |>
arrange(`Total by Area`) |>
# mutate(color = "") |>
gt(rowname_col = "stream") |>
tab_header(
title = md(paste("BID Quantities", fontawesome::fa("city") , "FMS-SAP")),
subtitle = "Status at 2023-12-19"
) |>
sub_missing()  |>
grand_summary_rows(
# columns = -c(color),
fns = list(
total = ~ sum(., na.rm = TRUE)
)
) |>
tab_options(
table.font.size = 24
) |>
tab_style(
style = cell_fill(color = "pink"),
locations = cells_grand_summary(
columns = `Deviation from Global way of working`,
rows = 1
)
) |>
# data_color(
#   columns = `3rd Party Integration`,
#   rows =  `3rd Party Integration` > 5,
#   method = "numeric",
#   palette = c("lightblue", "pink"),
#   domain = c(0, 10)
# )  |>
cols_label(
`Legal Requirement` = "Legal<br>Requirement",
`3rd Party Integration` = "3rd Party<br>Integration",
`Baseline & Localization` = "Baseline &<br>Localization",
`Deviation from Global way of working` = "Deviation<br>from Global<br>way of<br>working",
`Total by Area` = "Totals",
.fn = md
) |>
data_color(
columns = `Total by Area`,
#rows =  `Total by Area` > 15,
method = "numeric",
palette = c("lightblue", "pink"),
domain = c(0, 20)
)
in_data_s2 |>
filter(!is.na(stream)) |>
filter(!str_detect(status, "99. Cancelled")) |>
filter(!is.na(charm_number)) |>
filter(!str_detect(charm_number, "Wait")) |>
filter(!str_detect(charm_number, "NA")) |>
select(stream, charm_number, bid_classification) |>
count(stream, bid_classification, sort = T) |>
filter(!is.na(bid_classification)) |>
filter(!str_detect(bid_classification, "NA")) |>
filter(!str_detect(bid_classification, "template")) |>
mutate(bid_classification = case_when(
str_detect(bid_classification, "Legal") ~ "Legal Requirement",
str_detect(bid_classification, "Integration") ~ "3rd Party Integration",
str_detect(bid_classification, "Waiting") ~ "3rd Party Integration",
TRUE ~ bid_classification
)) |>
count(stream, bid_classification, wt = n) |>
group_by(stream) |>
mutate(`Total by Area` = sum(n)) |>
ungroup() |>
pivot_wider(names_from = bid_classification,
values_from = n) |>
relocate(`Legal Requirement`, .after = last_col()) |>
relocate(`3rd Party Integration`, .after = last_col()) |>
relocate(`Baseline & Localization`, .after = last_col()) |>
relocate(`Deviation from Global way of working`, .after = last_col()) |>
relocate(`Total by Area`, .after = last_col()) |>
arrange(`Total by Area`) |>
# mutate(color = "") |>
gt(rowname_col = "stream") |>
tab_header(
title = md(paste("BID Quantities", fontawesome::fa("city") , "FMS-SAP")),
subtitle = "Status at 2023-12-19"
) |>
sub_missing()  |>
grand_summary_rows(
# columns = -c(color),
fns = list(
total = ~ sum(., na.rm = TRUE)
)
) |>
tab_options(
table.font.size = 24
) |>
tab_style(
style = cell_fill(color = "darkred"),
locations = cells_grand_summary(
columns = `Deviation from Global way of working`,
rows = 1
)
) |>
# data_color(
#   columns = `3rd Party Integration`,
#   rows =  `3rd Party Integration` > 5,
#   method = "numeric",
#   palette = c("lightblue", "pink"),
#   domain = c(0, 10)
# )  |>
cols_label(
`Legal Requirement` = "Legal<br>Requirement",
`3rd Party Integration` = "3rd Party<br>Integration",
`Baseline & Localization` = "Baseline &<br>Localization",
`Deviation from Global way of working` = "Deviation<br>from Global<br>way of<br>working",
`Total by Area` = "Totals",
.fn = md
) |>
data_color(
columns = `Total by Area`,
#rows =  `Total by Area` > 15,
method = "numeric",
palette = c("lightblue", "pink"),
domain = c(0, 20)
)
in_data_s2 |>
filter(!is.na(stream)) |>
filter(!str_detect(status, "99. Cancelled")) |>
filter(!is.na(charm_number)) |>
filter(!str_detect(charm_number, "Wait")) |>
filter(!str_detect(charm_number, "NA")) |>
select(stream, charm_number, bid_classification) |>
count(stream, bid_classification, sort = T) |>
filter(!is.na(bid_classification)) |>
filter(!str_detect(bid_classification, "NA")) |>
filter(!str_detect(bid_classification, "template")) |>
mutate(bid_classification = case_when(
str_detect(bid_classification, "Legal") ~ "Legal Requirement",
str_detect(bid_classification, "Integration") ~ "3rd Party Integration",
str_detect(bid_classification, "Waiting") ~ "3rd Party Integration",
TRUE ~ bid_classification
)) |>
count(stream, bid_classification, wt = n) |>
group_by(stream) |>
mutate(`Total by Area` = sum(n)) |>
ungroup() |>
pivot_wider(names_from = bid_classification,
values_from = n) |>
relocate(`Legal Requirement`, .after = last_col()) |>
relocate(`3rd Party Integration`, .after = last_col()) |>
relocate(`Baseline & Localization`, .after = last_col()) |>
relocate(`Deviation from Global way of working`, .after = last_col()) |>
relocate(`Total by Area`, .after = last_col()) |>
arrange(`Total by Area`) |>
# mutate(color = "") |>
gt(rowname_col = "stream") |>
tab_header(
title = md(paste("BID Quantities", fontawesome::fa("city") , "FMS-SAP")),
subtitle = "Status at 2023-12-19"
) |>
sub_missing()  |>
grand_summary_rows(
# columns = -c(color),
fns = list(
total = ~ sum(., na.rm = TRUE)
)
) |>
tab_options(
table.font.size = 24
) |>
tab_style(
style = cell_fill(color = "darkred"),
locations = cells_grand_summary(
columns = `Deviation from Global way of working`,
rows = 1
)
) |>
# data_color(
#   columns = `3rd Party Integration`,
#   rows =  `3rd Party Integration` > 5,
#   method = "numeric",
#   palette = c("lightblue", "pink"),
#   domain = c(0, 10)
# )  |>
cols_label(
`Legal Requirement` = "Legal<br>Requirement",
`3rd Party Integration` = "3rd Party<br>Integration",
`Baseline & Localization` = "Baseline &<br>Localization",
`Deviation from Global way of working` = "Deviation<br>from Global<br>way of<br>working",
`Total by Area` = "Totals",
.fn = md
) |>
data_color(
columns = `Total by Area`,
#rows =  `Total by Area` > 15,
method = "numeric",
palette = c("lightblue", "pink"),
domain = c(0, 16)
)
in_data_s2 |>
filter(!is.na(stream)) |>
filter(!str_detect(status, "99. Cancelled")) |>
filter(!is.na(charm_number)) |>
filter(!str_detect(charm_number, "Wait")) |>
filter(!str_detect(charm_number, "NA")) |>
select(stream, charm_number, bid_classification) |>
count(stream, bid_classification, sort = T) |>
filter(!is.na(bid_classification)) |>
filter(!str_detect(bid_classification, "NA")) |>
filter(!str_detect(bid_classification, "template")) |>
mutate(bid_classification = case_when(
str_detect(bid_classification, "Legal") ~ "Legal Requirement",
str_detect(bid_classification, "Integration") ~ "3rd Party Integration",
str_detect(bid_classification, "Waiting") ~ "3rd Party Integration",
TRUE ~ bid_classification
)) |>
count(stream, bid_classification, wt = n) |>
group_by(stream) |>
mutate(`Total by Area` = sum(n)) |>
ungroup() |>
pivot_wider(names_from = bid_classification,
values_from = n) |>
relocate(`Legal Requirement`, .after = last_col()) |>
relocate(`3rd Party Integration`, .after = last_col()) |>
relocate(`Baseline & Localization`, .after = last_col()) |>
relocate(`Deviation from Global way of working`, .after = last_col()) |>
relocate(`Total by Area`, .after = last_col()) |>
arrange(`Total by Area`) |>
# mutate(color = "") |>
gt(rowname_col = "stream") |>
tab_header(
title = md(paste("BID Quantities", fontawesome::fa("city") , "FMS-SAP")),
subtitle = "Status at 2023-12-19"
) |>
sub_missing()  |>
grand_summary_rows(
# columns = -c(color),
fns = list(
total = ~ sum(., na.rm = TRUE)
)
) |>
tab_options(
table.font.size = 24
) |>
tab_style(
style = list(
cell_fill(color = "darkred"),
cell_text(color = "white")),
locations = cells_grand_summary(
columns = `Deviation from Global way of working`,
rows = 1
)
) |>
# data_color(
#   columns = `3rd Party Integration`,
#   rows =  `3rd Party Integration` > 5,
#   method = "numeric",
#   palette = c("lightblue", "pink"),
#   domain = c(0, 10)
# )  |>
cols_label(
`Legal Requirement` = "Legal<br>Requirement",
`3rd Party Integration` = "3rd Party<br>Integration",
`Baseline & Localization` = "Baseline &<br>Localization",
`Deviation from Global way of working` = "Deviation<br>from Global<br>way of<br>working",
`Total by Area` = "Totals",
.fn = md
) |>
data_color(
columns = `Total by Area`,
#rows =  `Total by Area` > 15,
method = "numeric",
palette = c("lightblue", "pink"),
domain = c(0, 16)
)
