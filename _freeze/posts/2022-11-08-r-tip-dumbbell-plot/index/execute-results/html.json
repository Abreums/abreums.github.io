{
  "hash": "e852b869315d740f6af8be36bb9090ac",
  "result": {
    "markdown": "---\ntitle: \"R tip: dumbbell plot\"\ndescription: \"Dumbbell plots are good to compaire different values of a measurement, showing difference. Similar to dodged bar charts, but much better\"\ndate: 2022-11-08\nauthor: \n  - name: Marcos Abreu\n    url: https://abreums.github.io\n    orcid: 0000-0003-4772-7955\ncitation:\n  type: post-weblog\n  url: https://abreums.github.io/posts/2022-11-08-r-tip-dumbbell-plot/\n  language: pt-br\nimage: dumbbell.png\ncategories: [Rstat]\n---\n\n\nCompairing values are very trick in dataviz.\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r setup}}\n#| warning: false\n#| message: false\n\nlibrary(tidyverse)\nlibrary(ggtext)\nlibrary(gapminder)\n\nsouth_america <- \n  c(\"Argentina\", \"Bolivia\", \"Brazil\", \"Chile\",\n    \"Colombia\", \"Ecuador\", \"Paraguay\", \"Peru\",\n    \"Uruguay\", \"Venezuela\")\n\nsouth_america_pop <- \n  gapminder::gapminder %>% \n  filter(country %in% south_america) %>% \n  filter(year == min(year) | year == max(year)) %>% \n  select(country, year, pop)\n```\n````\n:::\n\n\nGetting life expectancy from South America contries.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsouth_america_pop %>% \n  mutate(year = factor(as.character(year)),\n         country = fct_reorder(country, pop)) %>% \n  ggplot(aes(x = country, y = pop, fill = year)) +\n  geom_col(position = position_dodge2())  +\n  scale_fill_manual(\n    name = NULL,\n    values = c(`1952` = \"#D55E00\", `2007` = \"#009E73\"),\n    labels = c(`1952` = \"<i style='color:#D55E00'>1952</i>\",\n               `2007` = \"<i style='color:#009E73'>2007</i>\")\n  ) +\n  labs(title = \"Evolução Populacional de\n                <span style='color:#D55E00;'><i>1952</i></span> a \n                <span style='color:#009E73;'><i>2007</i></span>\",\n       subtitle = \"América do Sul\",\n       x = NULL,\n       y = NULL,\n       fill = NULL) +\n  theme_minimal() +\n  theme(\n    #legend.position = \"none\",\n    plot.title = element_markdown(lineheight = 1.1),\n    legend.text = element_markdown(size = 11),\n    axis.text.x = element_blank(),\n    panel.grid.major.x = element_blank(),\n    panel.grid.major.y = element_blank()\n  ) +\n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/dodged_bar_plot-1.png){width=672}\n:::\n:::\n\n\nAn alternative for the dodged bar plot is the dumbbell plot.\n\nLet's build one...\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# adjust data for segment plot\nsegment_line <- \n  south_america_pop %>% \n    pivot_wider(names_from = year, values_from = pop, names_prefix = 'year_') %>% \n    mutate(\n      change = year_2007 - year_1952,\n      country = fct_reorder(country, change)\n    )\n# adjust data for points plot\nsouth_america_pop <- \n  south_america_pop %>% \n  mutate(year = factor(year))\n\ndumbbell_plot <- \n  ggplot() +\n  geom_segment(\n    data = segment_line,\n    aes(y = country, yend = country, x = year_1952, xend = year_2007),\n      col = 'grey60',\n      size = 1.25\n    ) +\n  geom_point(\n    data = south_america_pop,\n    aes(x = pop, y = country, colour = year), size = 4\n    ) +\n  scale_color_manual(\n    name = NULL,\n    values = c(`1952` = \"#D55E00\", `2007` = \"#009E73\"),\n    labels = c(`1952` = \"<i style='color:#D55E00'>1952</i>\",\n               `2007` = \"<i style='color:#009E73'>2007</i>\")\n  ) +\n  labs(title = \"Evolução Populacional de\n                <span style='color:#D55E00;'><i>1952</i></span> a \n                <span style='color:#009E73;'><i>2007</i></span>\",\n       subtitle = \"América do Sul\",\n       x = NULL,\n       y = NULL,\n       fill = NULL) +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\",\n    plot.title = element_markdown(lineheight = 1.1),\n    legend.text = element_markdown(size = 11),\n    axis.text.x = element_blank(),\n    panel.grid.major.x = element_blank(),\n    panel.grid.major.y = element_blank()\n  ) \n\ndumbbell_plot\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/dumbbell_plot-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"dumbbell.png\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nSaving 7 x 5 in image\n```\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}