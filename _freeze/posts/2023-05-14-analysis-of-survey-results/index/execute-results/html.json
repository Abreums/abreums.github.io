{
  "hash": "6478727b17f46ab781a2e210af99a813",
  "result": {
    "markdown": "---\ntitle: \"Análise de resultados de pesquisas\"\ndescription: \"Neste post vamos falar sobre a apresentação visual de resultados de pesquisas com perguntas no estilo likert\"\ndate: 2023-05-14\nauthor: \n  - name: Marcos Abreu\n    url: https://abreums.github.io\n    orcid: 0000-0003-4772-7955\ncitation:\n  type: post-weblog\n  url: https://abreums.github.io/posts/2023-05-14-analysis-of-survey-results/\n  language: pt-br\nimage: stackedbars.png\ncategories: [Gestão de Mudanças, Rstats]\n---\n\n\nUma das formas de apresentar o resultado de pesquisas é utilizar gráficos de barras empilhadas na horizontal. Vamos ver como isto funciona.\n\nNossa pesquisa possui 2 perguntas inspiradas no levantamento de intenção:\n\n1.  O projeto trará mudanças que deixarão o trabalho mais efetivo.\n2.  Minha equipe considera que o projeto trará mudanças que deixarão o trabalho mais efetivo.\n\nPara cada pergunta o respondente seleciona um valor de 1 a 7, onde 1 significa que \"Discorda totalmente\" e 7 significa que \"Concorda totalmente\".\n\nPara este post basta saber que as perguntas visam comparar o que o entrevistado tem de atitude (pergunta 1) e de norma percebida (pergunta 2). Comparar as respostas destas perguntas nos permite avaliar como a percepção do associado é influenciada por suas atitudes (\"o que ele acha\") e pelas normas sociais que ele percebe (\"o que ele acha que os outros acham\"). Há um post no blog específico sobre como montar questões com este objetivo.\n\nNeste exemplo, as perguntas estão sendo utilizadas para demonstrar que em pesquisas é comum durante a análise dos resultados comparar as quantidades de respostas recebidas para diferentes perguntas.\n\nEntão, a pergunta é: Qual é a melhor forma de comparar as respostas destas perguntas?\n\nVamos construir um exemplo hipotético para avaliar as alternativas. Consideremos um universo de 50 entrevistados cujas as respostas oscilaram entre 1 e 7 aleatóriamente.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nset.seed(123)\n\n# just creating (almost) random numbers\nsurvey_data <- tibble(\n  Q1 = rnorm(100, mean = 5, sd = 3),\n  Q2 = rnorm(100, mean = 4.5, sd = 2)\n)\nsurvey_data <- \n  survey_data |> \n  mutate(Q1 = if_else(Q1 > 7, 7, Q1),\n         Q1 = if_else(Q1 < 1, 1, Q1),\n         Q2 = if_else(Q2 > 7, 7, Q2),\n         Q2 = if_else(Q2 < 1, 1, Q2)) |>\n  mutate(Q1 = if_else(Q1 > 4.5, ceiling(Q1), floor(Q1)),\n         Q2 = if_else(Q2 > 4.5, ceiling(Q2), floor(Q2))) |> \n  mutate(Q1 = factor(as.character(Q1), \n                     levels = c(\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\"),\n                     ordered = TRUE),\n         Q2 = factor(as.character(Q2), \n                     levels = c(\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\"),\n                     ordered = TRUE))\n```\n:::\n\n\nO primeiro passo é obter os percentuais para cada tipo de resposta.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsQ1 <- \n  survey_data |> \n  count(Q1) |> \n  mutate(p = n / sum(n),\n         question = \"Q1\") |> \n  rename(level = Q1) |> \n  select(question, level, p)\nsQ2 <- \n  survey_data |> \n  count(Q2) |> \n  mutate(p = n / sum(n),\n         question = \"Q2\") |> \n  rename(level = Q2) |> \n  select(question, level, p)\n\nsdt <- rbind(sQ1, sQ2)\n```\n:::\n\n\nVamos começar comparando *stacked bars* com *divergin stacked bars* (você já vai ver a diferença entre os dois).\n\n### Stacked Bars\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlik_colors = c(\"1\" = \"#C71E1D\", \"2\" = \"#D55457\", \"3\" = \"#E48F8F\", \"4\" = \"#B5AAB9\", \"5\" = \"#748CA5\", \"6\" = \"#17627B\", \"7\" = \"#174664\")\nsdt |> \n  ggplot(aes(question, p, label = paste0(as.character(100*p),\"%\"), fill = forcats::fct_rev(level))) +\n  geom_col(position = \"stack\") +\n  geom_text(size = 3, position = position_stack(vjust = 0.5)) +\n  theme_minimal() +\n  labs(title = \"Respostas para as questões Q1 (atitude) e Q2 (norma percebida)\",\n       x = NULL, y = NULL, fill = NULL) +\n  scale_fill_manual(values = lik_colors) +\n  coord_flip() +\n  theme(axis.text.x = element_blank(),\n        axis.title.x = element_blank(),\n        panel.grid = element_blank(),\n        legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nO gráfico nos mostra que mais de 50% dos entrevistados possui uma atitude (Q1) favorável ao questionamento. Mas esta posição é diferente quando avaliamos a norma percebida (Q2).\n\nOu seja, os entrevistados concordam que a mudança trará benefícios, mas não estão certos se seus pares consideram o mesmo.\n\nPara fazermos esta comparação é útil avaliar os pesos das respostas nos extremos. O gráfico de barras empilhado nos ajuda nesta tarefa. Fica fácil comparar que as respostas de Q1 e Q2 diferem nos valores de 1 e 2, 6 e 7. Nestes casos importam menos as comparações entre as quantidades de respostas de 3, 4 e 5.\n\n### Diverging Stacked Bars\n\nTambém são populares os gráficos de barras empilhados divergentes (*diverging stacked bars*). Vamos construir estes gráficos para os mesmos dados.\n\nUma decisão importante nos gráficos divergentes é se vamos ou não incluir o valor neutro (4) no gráfico. Não há consenso sobre esta questão, e particularmente eu prefiro a opção de **não** incluir, conforme argumentado pelos autores deste [post](https://blog.datawrapper.de/divergingbars/ \"The case against diverging stacked bars\").\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(scales)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'scales'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:purrr':\n\n    discard\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:readr':\n\n    col_factor\n```\n:::\n\n```{.r .cell-code}\nlibrary(patchwork)\n\n# Separar o valor neutro\nsdt_neutral <- sdt |> filter(level == 4)\nsdt_nonneutral <- sdt |> filter(level != 4)\n\np1 <-\n  sdt_nonneutral |> \n  mutate(tlabel = paste0((100*p), \"%\"), # definir o label percentual\n         p = if_else(level %in% c(1,2,3), -p, p), # ajustar os valores\n         level = factor(level, levels = c(\"3\", \"2\", \"1\", \"4\", \"5\", \"6\", \"7\"))) |> # ajustar a ordem de apresentação \n  ggplot(aes(p, question, fill = fct_rev(level), label = tlabel)) +\n  geom_col() +\n  geom_text(size = 2.5, position = position_stack(vjust = 0.5)) +\n  scale_fill_manual(values = lik_colors) +\n  theme_bw() +\n  labs(x = NULL, y = NULL) +\n  scale_x_continuous(\n      breaks = seq(-1, 1, .2),\n      labels = ~ scales::percent(abs(.x)),\n      expand = c(0.01, 0),\n      limits = c(-.5, .6)\n    ) +\n  coord_cartesian(clip = \"off\") +\n  geom_vline(xintercept = 0)\n  \np2 <- \n  sdt_neutral |> \n  mutate(tlabel = paste0((100*p), \"%\"),\n         p = if_else(level %in% c(1,2,3), -p, p),\n         level = factor(level, levels = c(\"3\", \"2\", \"1\", \"4\", \"5\", \"6\", \"7\"))) |> \n  ggplot(aes(p, question , fill = fct_rev(level), label = tlabel)) +\n  geom_col() +\n  geom_text(size = 2.5, position = position_stack(vjust = 0.5)) +\n  scale_fill_manual(values = lik_colors) +\n  theme_bw() +\n  labs(x = NULL, y = NULL) + \n  scale_x_continuous(\n      breaks = seq(-1, 1, .1),\n      labels = ~ scales::percent(abs(.x)),\n      expand = c(0.01, 0),\n      limits = c(-0.001, 0.12)\n    )\n\np1 + p2 +\n  plot_layout(widths = c(4, 1), guides = \"collect\") &\n  plot_annotation(\"Respostas para as questões Q1 (atitude) e Q2 (norma percebida)\",\n                  theme=theme(plot.title=element_text(hjust=0.5))) &\n  theme(\n    legend.position = \"none\", \n    # legend.margin = margin(5, 0, 5, 0), \n    # legend.box.margin = margin(0, 0, -10, 0),\n    # legend.justification = \"right\",\n    plot.margin = margin(10, 10, 10, 10)\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## Conclusões\n\nOs gráficos de barras empilhadas divergentes seriam úteis caso desejássemos comparar os valores intermediários (3 e 5, no caso). Para respostas da survey, é mais importante comparar os valores extremos, e por isto o gráfico empilhado permite uma comparação mais efetiva.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}