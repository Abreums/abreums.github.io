{
  "hash": "dfb86d3b351bcaeb15d0d07ac5f2bd24",
  "result": {
    "markdown": "---\ntitle: \"ggimage\"\ndescription: \"Using ggimage with geom_segment\"\ndate: 2023-01-25\nauthor: \n  - name: Marcos Abreu\n    url: https://abreums.github.io\n    orcid: 0000-0003-4772-7955\ncitation:\n  type: post-weblog\n  url: https://abreums.github.io/posts/2023-01-25-ggimage/\n  language: pt-br\nimage: \"ggimage_test.png\"\ncategories: [News]\neditor_options: \n  chunk_output_type: console\n---\n\n\nEstou estudando [este código](https://github.com/nrennie/tidytuesday/tree/main/2023/2023-01-24) para aprender a utilizar ggimage.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.3.6      ✔ purrr   0.3.4 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.4.1 \n✔ readr   2.1.2      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(showtext)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: sysfonts\nLoading required package: showtextdb\n```\n:::\n\n```{.r .cell-code}\nlibrary(camcorder)\nlibrary(magick)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLinking to ImageMagick 6.9.12.3\nEnabled features: cairo, fontconfig, freetype, heic, lcms, pango, raw, rsvg, webp\nDisabled features: fftw, ghostscript, x11\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggimage)\nlibrary(palmerpenguins)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#load fonts\nfont_add_google(\"Cinzel Decorative\", \"cinzel\")\nfont_add_google(\"Roboto\", \"roboto\")\nshowtext_auto()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# plot data\nplot_data <- \n  penguins |> \n  count(species) |> \n  mutate(species = fct_reorder(species, n))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Process images\n# custom function to apply border to circle image with magick\n# Code: https://github.com/tashapiro/tanya-data-viz/blob/main/spotify-artists/scripts/generate-image-labels.R\nborder <- function(im) {\n  ii <- magick::image_info(im)\n  ii_min <- min(ii$width, ii$height)\n  \n  img <- magick::image_blank(width = ii_min, height = ii_min, color = \"none\")\n  drawing <- image_draw(img)\n  symbols(ii_min/2, ii_min/2, circles = ii_min/2, bg = 'white', inches = FALSE, add = TRUE)\n  dev.off()\n  \n  x = image_composite(image_scale(drawing, \"x430\"), image_scale(im, \"x400\"), offset = \"+15+15\")\n  \n  x\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nst <- \"Amount of penguins in the Palmer Penguins library dataset\"\n\nggplot(data = plot_data) +\n  geom_segment(mapping = aes(x = 0, \n                             xend = n,\n                             y = species,\n                             yend= species),\n               colour = \"#f4f7f7\",\n               size = 1) +\n  geom_image(mapping = aes(x = n,\n                           y = species,\n                           # image = paste0(\"posts/2023-01-25-ggimage/images/\", species, \".png\")),\n                           image = paste0(\"images/\", species, \".png\")),\n             asp = 2,\n             size = 0.12,\n             image_fun = border) +\n  geom_text(mapping = aes(x = n + 16, \n                          y = species,\n                          label = species),\n            size = 9,\n            hjust = 0,\n            family = \"roboto\",\n            colour = \"#f4f7f7\") +\n    scale_y_discrete(limits = rev) +\n  scale_x_continuous(breaks = c(0, 50, 100, 150),\n                     limits = c(-5, 250),\n                     expand = c(0, 0)) +\n   labs(title = \"PALMER PENGUINS\",\n       subtitle = str_wrap(st, 70),\n       x = NULL,\n       y = NULL) +\n  theme(axis.text = element_text(family = \"roboto\",\n                                 size = 24,\n                                 lineheight = 0.4,\n                                 colour = \"#f4f7f7\"),\n        axis.text.y = element_blank(),\n        axis.title = element_text(family = \"roboto\",\n                                  size = 24,\n                                  lineheight = 0.4,\n                                  margin = margin(t = 10),\n                                  colour = \"#f4f7f7\"),\n        axis.ticks = element_blank(),\n        plot.subtitle = element_text(family = \"roboto\",\n                                     size = 18,\n                                     hjust = 0.5,\n                                     lineheight = 0.4,\n                                     margin = margin(b = 10),\n                                     colour = \"#f4f7f7\"),\n        plot.title = element_text(family = \"cinzel\",\n                                  size = 44,\n                                  hjust = 0.5,\n                                  margin = margin(b = 10),\n                                  colour = \"#f4f7f7\"),\n        plot.margin = margin(10, 10, 10, 10),\n        panel.grid.minor = element_blank(),\n        panel.grid.major.y = element_blank(),\n        plot.title.position = \"plot\",\n        panel.grid.major.x = element_line(linetype = \"dashed\",\n                                          colour = alpha(\"#bb8899\", 0.3)),\n        plot.background = element_rect(fill = \"#203d58\", colour = \"#203d58\"),\n        panel.background = element_rect(fill = \"#203d58\", colour = \"#203d58\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}